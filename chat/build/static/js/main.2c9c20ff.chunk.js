(this.webpackJsonpchat=this.webpackJsonpchat||[]).push([[0],{118:function(e,t,a){"use strict";a.r(t);var s=a(74);t.default=Object(s.c)(["messages","dialogs","user"].reduce((function(e,t){return e[t]=a(239)("./".concat(t)).default,e}),{}))},163:function(e,t,a){"use strict";a.r(t);var s=a(19),n={items:[],currentDialogId:window.location.pathname.split("dialog/")[1],isLoading:!1};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n,t=arguments.length>1?arguments[1]:void 0,a=t.type,c=t.payload;switch(a){case"DIALOGS:SET_ITEMS":return Object(s.a)(Object(s.a)({},e),{},{items:c});case"DIALOGS:LAST_MESSAGE_READED_STATUS":return Object(s.a)(Object(s.a)({},e),{},{items:e.items.map((function(e){return e._id===c.dialogId&&(e.lastMessage.readed=!0),e}))});case"DIALOGS:SET_CURRENT_DIALOG_ID":return Object(s.a)(Object(s.a)({},e),{},{currentDialogId:c});default:return e}}},164:function(e,t,a){"use strict";a.r(t);var s=a(224),n=a(19),c={items:[],isLoading:!1};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,t=arguments.length>1?arguments[1]:void 0,a=t.type,i=t.payload;switch(a){case"MESSAGES:ADD_MESSAGE":return Object(n.a)(Object(n.a)({},e),{},{items:[].concat(Object(s.a)(e.items),[i])});case"MESSAGES:SET_ITEMS":return Object(n.a)(Object(n.a)({},e),{},{items:i,isLoading:!1});case"MESSAGES:SET_IS_LOADING":return Object(n.a)(Object(n.a)({},e),{},{isLoading:i});case"MESSAGES:REMOVE_MESSAGE":return Object(n.a)(Object(n.a)({},e),{},{items:e.items.filter((function(e){return e._id!==i}))});default:return e}}},165:function(e,t,a){"use strict";a.r(t);var s=a(19),n={data:null,token:window.localStorage.token,isAuth:!!window.localStorage.token};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n,t=arguments.length>1?arguments[1]:void 0,a=t.type,c=t.payload;switch(a){case"USER:SET_DATA":return Object(s.a)(Object(s.a)({},e),{},{data:c,isAuth:!0,token:window.localStorage.token});case"USER:SET_IS_AUTH":return Object(s.a)(Object(s.a)({},e),{},{isAuth:c});default:return e}}},239:function(e,t,a){var s={"./dialogs":163,"./dialogs.js":163,"./indexReducers":118,"./indexReducers.js":118,"./messages":164,"./messages.js":164,"./user":165,"./user.js":165};function n(e){var t=c(e);return a(t)}function c(e){if(!a.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}n.keys=function(){return Object.keys(s)},n.resolve=c,e.exports=n,n.id=239},240:function(e,t,a){},242:function(e,t,a){},243:function(e,t,a){},259:function(e,t,a){},260:function(e,t,a){},261:function(e,t,a){},352:function(e,t,a){},353:function(e,t,a){},358:function(e,t,a){},405:function(e,t,a){},406:function(e,t,a){},407:function(e,t,a){},408:function(e,t,a){},409:function(e,t,a){"use strict";a.r(t);var s=a(1),n=a(0),c=a.n(n),i=a(28),r=a.n(i),o=a(43),l=a(74),u=a(206),d=a(118),j=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||l.d,h=[u.a],b=Object(l.e)(d.default,j(l.a.apply(void 0,h))),O=(a(240),a(241),a(62)),g=a(27),m=a(132),f=a(412),p=a(414),x=a(424),v=a(425),_=a(19),S=a(5),E=a.n(S),w=a(77);a(242);var y=function(e){return Object(s.jsx)(w.a,Object(_.a)(Object(_.a)({},e),{},{className:E()("button",e.className,{"button--large":"large"===e.size})}))};a(243);var N=function(e){var t=e.children,a=e.className;return Object(s.jsx)("div",{className:E()("block",a),children:t})},I=a(24),A=a(156),D=a(417),M=a(418),k=function(e,t,a){return t[e]?a[e]?"error":"success":""},R=function(e){var t=Math.floor(e/60),a=(e%60).toFixed();return"".concat(t<10?"0":"").concat(t,":").concat(a<10?"0":"").concat(a)},L=a(159),C=a.n(L),T=a(229),G=function(e){var t=e.text,a=e.type,s=void 0===a?"info":a,n=e.title,c=e.duration,i=void 0===c?3:c;return T.a[s]({message:n,description:t,duration:i})},U=a.p+"static/media/readed.8776dd59.svg",V=a.p+"static/media/no-read.c7c02e84.svg",z=a.p+"static/media/readedWhite.3b3841a1.svg",F=a.p+"static/media/no-readWhite.9c692567.svg",B=a.p+"static/media/wave.a4b496b3.svg",P=a.p+"static/media/play.870c9d04.svg",H=a.p+"static/media/pause.2b5edbe9.svg",W=a(222),J=a(210),Z=a.n(J),q=function(e){var t=new Date(e);return new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds())},X=function(e){var t=e.date;return Object(s.jsx)(n.Fragment,{children:Object(W.a)(q(t),{addSuffix:!0,locale:Z.a})})},Y=(a(259),function(e){var t=e.user;if(t.avatar)return Object(s.jsx)("img",{className:"avatar",src:t.avatar,alt:"Avatar ".concat(t.fullname)});var a=function(e){var t=e.substr(0,3).split("").map((function(e){return(t=e.charCodeAt(0))>255?255:t<0?0:t>255?255:t<0?0:t;var t})),a=Object(I.a)(t,3),s=a[0],n=a[1],c=a[2];return{color:C()({r:s,g:n,b:c}).lighten(10).saturate(10).toHexString(),colorLighten:C()({r:s,g:n,b:c}).lighten(30).saturate(30).toHexString()}}(t._id),n=a.color,c=a.colorLighten,i=t.fullname[0].toUpperCase();return Object(s.jsx)("div",{style:{background:"linear-gradient(135deg, ".concat(n," 0%, ").concat(c," 96.52%)")},className:"avatar avatar--symbol",children:i})}),K=(a(260),function(e){var t=e.isMe,a=e.isReaded;return t?a?Object(s.jsx)("img",{className:"message__icon-readed",src:U,alt:"Readed icon"}):Object(s.jsx)("img",{className:"message__icon-readed message__icon-readed--no",src:V,alt:"No readed icon"}):null}),$=function(e){var t=e.audioSrc,a=Object(n.useRef)(null),c=Object(n.useState)(!1),i=Object(I.a)(c,2),r=i[0],o=i[1],l=Object(n.useState)(0),u=Object(I.a)(l,2),d=u[0],j=u[1],h=Object(n.useState)(0),b=Object(I.a)(h,2),O=b[0],g=b[1];return Object(n.useEffect)((function(){a.current.volume="0.1",a.current.addEventListener("playing",(function(){o(!0)}),!1),a.current.addEventListener("ended",(function(){o(!1),j(0),g(0)}),!1),a.current.addEventListener("pause",(function(){o(!1)}),!1),a.current.addEventListener("timeupdate",(function(){var e=a.current&&a.current.duration||0;g(a.current.currentTime),j(a.current.currentTime/e*100)}))}),[]),Object(s.jsxs)("div",{className:"message__audio",children:[Object(s.jsx)("audio",{volume:"0.1",ref:a,src:t,preload:"auto"}),Object(s.jsx)("div",{className:"message__audio-progress",style:{width:d+"%"}}),Object(s.jsxs)("div",{className:"message__audio-info",children:[Object(s.jsx)("div",{className:"message__audio-btn",children:Object(s.jsx)("button",{onClick:function(){r?a.current.pause():a.current.play()},children:r?Object(s.jsx)("img",{src:H,alt:"Pause svg"}):Object(s.jsx)("img",{src:P,alt:"Play svg"})})}),Object(s.jsx)("div",{className:"message__audio-wave",children:Object(s.jsx)("img",{src:B,alt:"Wave svg"})}),Object(s.jsx)("span",{className:"message__audio-duration",children:R(O)})]})]})};function Q(e){e.avatar;var t=e.user,a=e.text,n=e.date,c=e.audio,i=e.isMe,r=e.isReaded,o=e.attachments,l=e.isTyping,u=e.onRemoveMessage;return Object(s.jsxs)("div",{className:E()("message",{"message--isme":i,"message--is-typing":l,"message--is-audio":c,"message--image":o&&1===o.length}),children:[Object(s.jsx)(D.a,{content:Object(s.jsx)("div",{children:Object(s.jsx)(w.a,{onClick:u,children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})}),trigger:"click",children:Object(s.jsx)("div",{className:"message__icon-actions",children:Object(s.jsx)(w.a,{type:"link",shape:"circle",icon:Object(s.jsx)(M.a,{})})})}),Object(s.jsx)("div",{className:"message__avatar",children:Object(s.jsx)(Y,{user:t})}),Object(s.jsxs)("div",{className:"message__container",children:[(c||a||l)&&Object(s.jsxs)("div",{className:"message__bubble",children:[a&&Object(s.jsx)("p",{className:"message__text",children:a}),l&&Object(s.jsxs)("div",{className:"message__typing",children:[Object(s.jsx)("span",{}),Object(s.jsx)("span",{}),Object(s.jsx)("span",{})]}),c&&Object(s.jsx)($,{audioSrc:c}),Object(s.jsx)("div",{className:"chat-bubble"}),Object(s.jsxs)("div",{className:"icons_read_status-wrapper",children:[Object(s.jsx)(K,{isMe:i,isReaded:r,className:"message__check-icon--readed"}),Object(s.jsx)("img",{src:i?r?U:V:r?z:F,alt:"Check icon",className:"message__check-icon"})]})]}),o&&Object(s.jsx)("div",{className:"message__attachments",children:o.map((function(e,t){return Object(s.jsx)("div",{className:"message__attachments-item",children:Object(s.jsx)("img",{src:e.url,alt:e.filename})},t)}))}),n&&Object(s.jsx)("span",{className:"message__date",children:Object(s.jsx)(X,{date:n})})]})]})}Q.defaultProps={user:{}};var ee=Q,te=a(411),ae=a(95),se=(a(261),function(e){var t=e.onRemoveMessage,a=e.blockRef,n=e.isLoading,c=e.items,i=e.user;return Object(s.jsx)("div",{ref:a,className:E()("messages",{"messages--loading":n}),children:n?Object(s.jsx)(te.a,{size:"large",tip:"Loading..."}):c&&!n?c.length>0?c.map((function(e){return Object(s.jsx)(ee,Object(_.a)(Object(_.a)({},e),{},{isMe:i._id!==e.user._id,onRemoveMessage:t.bind(undefined,e._id)}),e._id)})):Object(s.jsx)(ae.a,{description:"\u0414\u0438\u0430\u043b\u043e\u0433 \u043f\u0443\u0441\u0442"}):Object(s.jsx)(ae.a,{description:"\u041d\u0435\u0442 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439"})})}),ne=a(162),ce=a(227),ie=function(e){var t=function(e){var t=new Date(e);return new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds())}(e);return Object(ce.a)(t)?Object(ne.a)(t,"HH:mm"):Object(ne.a)(t,"mm.dd.yyyy")},re=function(e){var t=e._id,a=(e.user,e.undread,e.created_at),n=(e.text,e.isMe),c=e.currentDialogId,i=e.onSelect,r=e.lastMessage;return Object(s.jsx)(O.b,{to:"/dialog/".concat(t),children:Object(s.jsxs)("div",{className:E()("dialogs__item",{"dialogs__item--online":r.user.isOnline,"dialogs__item--selected":c===t}),onClick:i.bind(undefined,t),children:[Object(s.jsx)("div",{className:"dialogs__item-avatar",children:Object(s.jsx)(Y,{user:r.user})}),Object(s.jsxs)("div",{className:"dialogs__item-info",children:[Object(s.jsxs)("div",{className:"dialogs__item-info-top",children:[Object(s.jsx)("b",{children:r.user.fullname}),Object(s.jsx)("span",{children:ie(a)})]}),Object(s.jsxs)("div",{className:"dialogs__item-info-bottom",children:[Object(s.jsx)("p",{children:r.text}),n&&Object(s.jsx)(K,{isMe:!0,isReaded:!1}),r.undread>0&&Object(s.jsx)("div",{className:"dialogs__item-info-bottom-count",children:r.undread>9?"+9":r.undread})]})]})]})})},oe=a(214),le=a.n(oe),ue=(a(352),function(e){var t=e.items,a=e.userId,n=e.onSearch,c=e.inputValue,i=e.currentDialogId,r=e.onSelectDialog;return Object(s.jsxs)("div",{className:"dialogs",children:[Object(s.jsx)("div",{className:"dialogs__search",children:Object(s.jsx)(p.a.Search,{placeholder:"\u041f\u043e\u0438\u0441\u043a \u0441\u0440\u0435\u0434\u0438 \u043a\u043e\u043d\u0442\u0430\u043a\u0442\u043e\u0432",onChange:function(e){return n(e.target.value)},value:c})}),t.length?le()(t,["desc"]).map((function(e){return Object(s.jsx)(re,Object(_.a)({isMe:e.author._id===a,userId:a,onSelect:r,currentDialogId:i,user:e.partner,created_at:e.lastMessage.createdAt,text:e.lastMessage.text},e),e._id)})):Object(s.jsx)(ae.a,{image:ae.a.PRESENTED_IMAGE_SIMPLE,description:"\u041d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e"})]})}),de=(a(353),function(e){var t=e.online,a=e.fullname;return Object(s.jsxs)("div",{className:"chat__dialog-header-center",children:[Object(s.jsx)("b",{className:"chat__dialog-header-username",children:a}),Object(s.jsx)("div",{className:"chat__dialog-header-status",children:Object(s.jsx)("span",{className:E()("status",{"status--online":t}),children:t?"\u043e\u043d\u043b\u0430\u0439\u043d":"\u043e\u0444\u043b\u0430\u0439\u043d"})})]})}),je=a(419),he=a(420),be=a(137),Oe=a(421),ge=a(215),me=(a(358),function(e){var t=Object(n.useState)(""),a=Object(I.a)(t,2),c=a[0],i=a[1],r=Object(n.useState)(!1),o=Object(I.a)(r,2),l=o[0],u=o[1],d=e.onSendMessage,j=e.currentDialogId;return Object(s.jsxs)("div",{className:"chat-input",children:[Object(s.jsxs)("div",{className:"chat-input__smile-btn",children:[l&&Object(s.jsx)("div",{className:"chat-input__emoji-piker",children:Object(s.jsx)(A.a,{set:"apple"})}),Object(s.jsx)(w.a,{onClick:function(){u(!l)},type:"link",shape:"circle",icon:Object(s.jsx)(je.a,{})})]}),Object(s.jsx)(p.a,{onChange:function(e){return i(e.target.value)},onKeyUp:function(e){13===e.keyCode&&(d(c,j),i(""))},size:"large",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043a\u0441\u0442 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f...",value:c}),Object(s.jsxs)("div",{className:"chat-input__actions",children:[Object(s.jsx)(ge.UploadField,{onFiles:function(e){return e},containerProps:{className:"chat-input__actions-upload-btn"},uploadProps:{accept:".jpg,.jpeg,.png,.gif,.bmp",multiple:"multiple"},children:Object(s.jsx)(w.a,{type:"link",shape:"circle",icon:Object(s.jsx)(he.a,{})})}),c?Object(s.jsx)(w.a,{type:"link",shape:"circle",icon:Object(s.jsx)(be.a,{})}):Object(s.jsx)(w.a,{type:"link",shape:"circle",icon:Object(s.jsx)(Oe.a,{})})]})]})}),fe=function(e){var t=e.name,a=e.placeholder,n=e.handleChange,c=e.handleBlur,i=e.icon,r=e.touched,o=e.errors,l=e.values,u=e.type;return Object(s.jsx)(f.a.Item,{validateStatus:k(t,r,o),help:r[t]?o[t]:"",hasFeedback:!0,children:Object(s.jsx)(p.a,{id:t,name:t,size:"large",placeholder:a,prefix:i,value:l[t],onChange:n,onBlur:c,type:u})})},pe=a(422),xe=a(423),ve=a(108),_e=a.n(ve);_e.a.defaults.baseURL=window.location.origin,_e.a.defaults.headers.common.token=window.localStorage.token,window.axios=_e.a;var Se=_e.a,Ee=function(){return Se.get("/dialogs")},we=function(e){var t=e.partner,a=e.text;return Se.post("/dialogs",{partner:t,text:a})},ye=function(e){return Se.get("/messages?dialog="+e)},Ne=function(e,t){return Se.post("/messages",{text:e,dialog:t})},Ie=function(e){return Se.delete("/messages?id="+e)},Ae=function(e){return Se.post("/user/login",e)},De=function(e){return Se.post("/user/registration",e)},Me=function(e){return Se.get("/user/verify?hash="+e)},ke=function(){return Se.get("/user/me/profile")},Re=function(e){return Se.get("/user/search")},Le=a(218),Ce=a.n(Le)()(window.location.origin.replace("3000","3003")),Te={setDialogs:function(e){return{type:"DIALOGS:SET_ITEMS",payload:e}},updateReadedStatus:function(e){return{type:"DIALOGS:LAST_MESSAGE_READED_STATUS",payload:{userId:e.userId,dialogId:e.dialogId}}},setCurrentDialogId:function(e){return function(t){Ce.emit("DIALOGS:JOIN",e),t({type:"DIALOGS:SET_CURRENT_DIALOG_ID",payload:e})}},fetchDialogs:function(){return function(e){Ee().then((function(t){var a=t.data;e(Te.setDialogs(a))}))}}},Ge=Te,Ue={setMessages:function(e){return{type:"MESSAGES:SET_ITEMS",payload:e}},addMessage:function(e){return function(t,a){a().dialogs.currentDialogId===e.dialog._id&&t({type:"MESSAGES:ADD_MESSAGE",payload:e})}},fetchSendMessage:function(e,t){return function(a){Ne(e,t)}},setIsLoading:function(e){return{type:"MESSAGES:SET_IS_LOADING",payload:e}},removeMessageById:function(e){return function(t){t({type:"MESSAGES:REMOVE_MESSAGE",payload:e}),Ie(e).then((function(e){e.data})).catch((function(){t(Ue.setIsLoading(!1))}))}},fetchMessages:function(e){return function(t){t(Ue.setIsLoading(!0)),ye(e).then((function(e){var a=e.data;t(Ue.setMessages(a))})).catch((function(){t(Ue.setIsLoading(!1))}))}}},Ve=Ue,ze={setUserData:function(e){return{type:"USER:SET_DATA",payload:e}},setIsAuth:function(e){return{type:"USER:SET_IS_AUTH",payload:e}},fetchUserData:function(){return function(e){ke().then((function(t){var a=t.data;e(ze.setUserData(a))})).catch((function(t){403===t.response.status&&(e(ze.setUserData(!1)),delete window.localStorage.token)}))}},fetchUserLogin:function(e){return function(t){return Ae(e).then((function(e){var a=e.data,s=a.token;return G({title:"\u041e\u0442\u043b\u0438\u0447\u043d\u043e!",text:"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f \u0443\u0441\u043f\u0435\u0448\u043d\u0430.",type:"success"}),window.axios.defaults.headers.common.token=s,window.localStorage.token=s,t(ze.fetchUserData()),t(ze.setIsAuth(!0)),a})).catch((function(e){403===e.response.status&&G({title:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438!",text:"\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u043b\u043e\u0433\u0438\u043d \u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c",type:"error"})}))}},fetchUserRegistration:function(e){return function(t){return De(e).then((function(e){var t=e.data;return window.localStorage.email_hash=t.obj.confirm_hash,t}))}}},Fe=ze,Be=Object(o.b)((function(e){return e.dialogs}),Ge)((function(e){var t=e.fetchDialogs,a=e.currentDialogId,c=e.setCurrentDialogId,i=e.items,r=e.userId,o=Object(n.useState)(""),l=Object(I.a)(o,2),u=l[0],d=l[1],j=Object(n.useState)(Array.from(i)),h=Object(I.a)(j,2),b=h[0],O=h[1],g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";O(i.filter((function(t){return t.author.fullname.toLowerCase().indexOf(e.toLowerCase())>=0||t.partner.fullname.toLowerCase().indexOf(e.toLowerCase())>=0}))),d(e)},m=function(){t()};return window.fetchDialogs=t,Object(n.useEffect)((function(){i.length&&g()}),[i]),Object(n.useEffect)((function(){return t(),Ce.on("SERVER:DIALOG_CREATED",m),Ce.on("SERVER:NEW_MESSAGE ",m),function(){Ce.removeListener("SERVER:DIALOG_CREATED",m),Ce.removeListener("SERVER:NEW_MESSAGE ",m)}}),[]),Object(s.jsx)(ue,{userId:r,items:b,onSearch:g,inputValue:u,onSelectDialog:c,currentDialogId:a})})),Pe=Object(o.b)((function(e){var t=e.dialogs,a=e.messages,s=e.user;return{currentDialogId:t.currentDialogId,items:a.items,isLoading:a.isLoading,user:s.data}}),Ve)((function(e){var t=e.currentDialogId,a=e.fetchMessages,c=e.addMessage,i=e.items,r=e.user,o=e.isLoading,l=e.removeMessageById,u=Object(n.useRef)(null),d=function(e){c(e)};return Object(n.useEffect)((function(){return t&&a(t),Ce.on("SERVER:NEW_MESSAGE ",d),function(){return Ce.removeListener("SERVER:NEW_MESSAGE ",d)}}),[t]),Object(n.useEffect)((function(){u.current.scrollTo(0,999999)}),[i]),Object(s.jsx)(se,{user:r,blockRef:u,items:i,isLoading:o,onRemoveMessage:l})})),He=Object(o.b)((function(e){return e.dialogs}),Ve)((function(e){var t=e.fetchSendMessage,a=e.currentDialogId;return Object(s.jsx)(me,{onSendMessage:t,currentDialogId:a})})),We=Object(o.b)((function(e){var t=e.dialogs,a=e.user;return{dialogs:t.items,currentDialogId:t.currentDialogId,user:a.data}}))((function(e){var t=e.currentDialogId,a=e.user,n=e.dialogs;if(!n.length||!t)return null;var c=n.filter((function(e){return e._id===t}))[0],i={};return i=c.author._id===a._id?c.partner:c.author,Object(s.jsx)(de,{online:i.isOnline,fullname:i.fullname})})),Je=Object(o.b)((function(e){return{user:e.user.data}}))((function(e){var t=e.user,a=Object(n.useState)(!1),c=Object(I.a)(a,2),i=c[0],r=c[1],o=Object(n.useState)(""),l=Object(I.a)(o,2),u=l[0],d=l[1],j=Object(n.useState)(""),h=Object(I.a)(j,2),b=h[0],O=h[1],g=Object(n.useState)([]),m=Object(I.a)(g,2),f=m[0],p=m[1],x=Object(n.useState)(!1),v=Object(I.a)(x,2),_=v[0],S=v[1],E=Object(n.useState)(!1),w=Object(I.a)(E,2),y=w[0],N=w[1],A=function(){r(!1)};return Object(s.jsx)($e,{user:t,inputValue:u,visible:i,isLoading:_,onClose:A,onShow:function(){r(!0)},onSearch:function(e){S(!0),Re(e).then((function(e){var t=e.data;p(t),S(!1)})).catch((function(){S(!1)}))},onChangeInput:function(e){d(e)},onSelectUser:function(e){N(e)},onModalOk:function(){we({partner:y,text:b}).then(A).catch((function(){S(!1)}))},onChangeTextArea:function(e){O(e.target.value)},messageText:b,selectedUserId:y,users:f})})),Ze=a(413),qe=a(415),Xe=(a(405),Ze.a.Option),Ye=p.a.TextArea,Ke=function(e){var t=e.user,a=e.visible,n=e.inputValue,c=e.messageText,i=e.selectedUserId,r=e.isLoading,o=e.users,l=e.onShow,u=e.onClose,d=e.onSearch,j=e.onChangeInput,h=e.onSelectUser,b=e.onChangeTextArea,O=e.onModalOk,g=o.map((function(e){return Object(s.jsx)(Xe,{children:e.fullname},e._id)}));return Object(s.jsxs)("div",{className:"chat__sidebar",children:[Object(s.jsxs)("div",{className:"chat__sidebar-header",children:[Object(s.jsxs)("div",{children:[Object(s.jsx)(pe.a,{}),Object(s.jsx)("span",{children:"\u0421\u043f\u0438\u0441\u043e\u043a \u0434\u0438\u0430\u043b\u043e\u0433\u043e\u0432"})]}),Object(s.jsx)(w.a,{onClick:l,type:"link",shape:"circle",icon:Object(s.jsx)(xe.a,{})})]}),Object(s.jsx)("div",{className:"chat__sidebar-dialogs",children:Object(s.jsx)(Be,{userId:t&&t._id})}),Object(s.jsx)(qe.a,{title:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0434\u0438\u0430\u043b\u043e\u0433",visible:a,onCancel:u,width:450,footer:[Object(s.jsx)(w.a,{onClick:u,children:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"},"back"),Object(s.jsx)(w.a,{disabled:!c,type:"primary",loading:r,onClick:O,children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"},"submit")],children:Object(s.jsxs)(f.a,{className:"add-dialog-form",children:[Object(s.jsx)(f.a.Item,{label:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0438\u043b\u0438 E-Mail",children:Object(s.jsx)(Ze.a,{className:"ant-form-item",value:n,onSearch:d,onChange:j,onSelect:h,notFoundContent:null,style:{width:"100%"},defaultActiveFirstOption:!1,showArrow:!1,filterOption:!1,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0438\u043b\u0438 \u043f\u043e\u0447\u0442\u0443",onClose:u,showSearch:!0,children:g})}),i&&Object(s.jsx)(f.a.Item,{label:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043a\u0441\u0442 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f",className:"ant-form-item",children:Object(s.jsx)(Ye,{autosize:{minRows:3,maxRows:10},onChange:b,value:c})})]})})]})};Ke.defaultProps={users:[]};var $e=Ke,Qe=function(e){var t=e.values,a=e.touched,n=e.errors,c=e.handleChange,i=e.handleBlur,r=e.handleSubmit,o=e.isValid,l=e.isSubmitting;return Object(s.jsxs)("div",{children:[Object(s.jsxs)("div",{className:"auth__top",children:[Object(s.jsx)("h2",{children:"\u0412\u043e\u0439\u0442\u0438 \u0432 \u0430\u043a\u043a\u0430\u0443\u043d\u0442"}),Object(s.jsx)("p",{children:"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u043e\u0439\u0434\u0438\u0442\u0435 \u0432 \u0441\u0432\u043e\u0439 \u0430\u043a\u043a\u0430\u0443\u043d\u0442"})]}),Object(s.jsx)(N,{children:Object(s.jsxs)(f.a,{onSubmit:r,className:"login-form",children:[Object(s.jsx)(f.a.Item,{validateStatus:k("email",a,n),help:a.email?n.email:"",hasFeedback:!0,children:Object(s.jsx)(p.a,{id:"email",prefix:Object(s.jsx)(x.a,{}),size:"large",placeholder:"E-mail",value:t.email,onChange:c,onBlur:i})}),Object(s.jsx)(f.a.Item,{validateStatus:k("password",a,n),help:a.password?n.password:"",hasFeedback:!0,children:Object(s.jsx)(p.a,{id:"password",prefix:Object(s.jsx)(v.a,{}),size:"large",type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",value:t.password,onChange:c,onBlur:i})}),Object(s.jsxs)(f.a.Item,{children:[l&&!o&&Object(s.jsx)("span",{children:"\u041e\u0448\u0438\u0431\u043a\u0430!"}),Object(s.jsx)(y,{disabled:l,onClick:r,type:"primary",size:"large",children:"\u0412\u043e\u0439\u0442\u0438 \u0432 \u0430\u043a\u043a\u0430\u0443\u043d\u0442"})]}),Object(s.jsx)(O.b,{className:"auth__login-link",to:"/registration",children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})]})})]})},et=function(e){var t=e.isAuth,a=e.values,s=e.errors,n={email:function(e){e?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(e)||(s.email="\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 e-mail"):s.email="\u0412\u0432\u0435\u0434\u0438\u0442\u0435 e-mail"},password:function(e){e?t||/^(?=.*[0-9])(?=.*[a-z])[0-9a-z]{6,}/.test(e)||(s.password=t?"\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c":"\u0421\u043b\u0438\u0448\u043a\u043e\u043c \u043b\u0435\u0433\u043a\u0438\u0439 \u043f\u0430\u0440\u043e\u043b\u044c"):s.password="\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c"},password_2:function(e){t||e===a.password||(s.password_2="\u041f\u0430\u0440\u043e\u043b\u0438 \u043d\u0435 \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u044e\u0442")},fullname:function(e){t||e||(s.fullname="\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u0441\u0432\u043e\u0435 \u0418\u043c\u044f \u0438 \u0424\u0430\u043c\u0438\u043b\u0438\u044e")}};Object.keys(a).forEach((function(e){return n[e]&&n[e](a[e])}))},tt=Object(m.a)({enableReinitialize:!0,mapPropsToValues:function(){return{email:"",password:""}},validate:function(e){var t={};return et({isAuth:!0,values:e,errors:t}),t},handleSubmit:function(e,t){var a=t.setSubmitting,s=t.props;b.dispatch(Fe.fetchUserLogin(e)).then((function(e){"success"===e.status&&s.history.push("/"),a(!1)})).catch((function(){a(!1)}))},displayName:"LoginForm"})(Qe),at=a(426),st=a(427),nt=a(230),ct=(a(428),function(e){var t=e.values,a=e.touched,n=e.errors,c=e.handleChange,i=e.handleBlur,r=e.handleSubmit,o=e.isSubmitting;return Object(s.jsxs)("div",{children:[Object(s.jsxs)("div",{className:"auth__top",children:[Object(s.jsx)("h2",{children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(s.jsx)("p",{children:"\u0414\u043b\u044f \u0432\u0445\u043e\u0434\u0430 \u0432 \u0447\u0430\u0442, \u0432\u0430\u043c \u043d\u0443\u0436\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})]}),Object(s.jsx)(N,{children:Object(s.jsxs)(f.a,{onSubmit:r,children:[Object(s.jsx)(fe,{name:"email",icon:Object(s.jsx)(x.a,{}),handleChange:c,handleBlur:i,placeholder:"E-mail",touched:a,errors:n,values:t,type:"text"}),Object(s.jsx)(fe,{name:"fullname",icon:Object(s.jsx)(at.a,{}),handleChange:c,handleBlur:i,placeholder:"\u0418\u043c\u044f \u0438 \u0424\u0430\u043c\u0438\u043b\u0438\u044f",touched:a,errors:n,values:t,type:"text"}),Object(s.jsx)(f.a.Item,{validateStatus:k("password",a,n),help:a.password?n.password:"",rules:[{required:!0,message:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0412\u0430\u0448 \u043f\u0430\u0440\u043e\u043b\u044c"}],children:Object(s.jsx)(p.a.Password,{id:"password",name:"password",type:"password",value:t.password,onChange:c,onBlur:i,size:"large",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",prefix:Object(s.jsx)(v.a,{}),iconRender:function(e){return e?Object(s.jsx)(st.a,{}):Object(s.jsx)(nt.a,{})}})}),Object(s.jsx)(f.a.Item,{validateStatus:k("password_2",a,n),help:a.password_2?n.password_2:"",name:"password",rules:[{required:!0,message:"\u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u0412\u0430\u0448 \u043f\u0430\u0440\u043e\u043b\u044c"}],children:Object(s.jsx)(p.a.Password,{id:"password_2",size:"large",name:"password_2",type:"password",value:t.password,onChange:c,onBlur:i,placeholder:"\u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c",prefix:Object(s.jsx)(v.a,{}),iconRender:function(e){return e?Object(s.jsx)(st.a,{}):Object(s.jsx)(nt.a,{})}})}),Object(s.jsx)(f.a.Item,{children:Object(s.jsx)(y,{disabled:o,onClick:r,type:"primary",size:"large",children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})}),Object(s.jsx)(O.b,{to:"/login",className:"auth__login-link",children:"\u0412\u043e\u0439\u0442\u0438 \u0432 \u0430\u043a\u043a\u0430\u0443\u043d\u0442"})]})})]})}),it=Object(m.a)({enableReinitialize:!0,mapPropsToValues:function(){return{email:"",fullname:"",password:"",password_2:""}},validate:function(e){var t={};return et({isAuth:!1,values:e,errors:t}),t},handleSubmit:function(e,t){var a=t.setSubmitting,s=t.props;b.dispatch(Fe.fetchUserRegistration(e)).then((function(e){var t=e.status;setTimeout((function(){"success"===t&&s.history.push("/registration/verify")}),300),a(!1)})).catch((function(){a(!1)}))},displayName:"RegistrationForm"})(ct),rt=a(416),ot=(a(406),function(e){var t=e.hash,a=e.verified;return t?a?{status:"success",title:"\u0413\u043e\u0442\u043e\u0432\u043e!",message:"\u0410\u043a\u043a\u0430\u0443\u043d\u0442 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d!"}:{status:"error",title:"\u041e\u0448\u0438\u0431\u043a\u0430",message:"\u0412\u044b \u0443\u043a\u0430\u0437\u0430\u043b\u0438 \u043d\u0435\u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0439 \u0438\u043b\u0438 \u043d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0445\u0435\u0448."}:{status:"info",title:"\u0421\u043e\u0440\u044f\u043d =)",message:"\u041a \u0441\u043e\u0436\u0430\u043b\u0435\u043d\u0438\u044e, \u043c\u044b \u043d\u0435 \u0443\u0441\u043f\u0435\u043b\u0438 \u043d\u0430\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u0439 \u0441\u0435\u0440\u0432\u0438\u0441, \u043f\u043e\u044d\u0442\u043e\u043c\u0443 \u0445\u044d\u0448 \u043d\u0435\u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e \u0445\u0440\u0430\u043d\u0438\u0442\u0441\u044f \u0432 LocalStorage. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0435 \u0430\u043a\u043a\u0430\u0443\u043d\u0442 \u0437\u0434\u0435\u0441\u044c"}}),lt=function(e){var t=e.location,a=e.history,c=t.search.split("hash=")[1],i=Object(n.useState)(!1),r=Object(I.a)(i,2),o=r[0],l=r[1],u=Object(n.useState)(!!c),d=Object(I.a)(u,2),j=d[0],h=d[1],b=Object(n.useState)(ot({hash:c,checking:j,verified:o})),O=Object(I.a)(b,2),g=O[0],m=O[1],f=function(e){var t=e.checking,a=e.verified;m(ot({hash:c,checking:t,verified:a})),l(a),h(t)};Object(n.useEffect)((function(){c&&Me(c).then((function(){f({verified:!0,checking:!1})})).catch((function(){f({verified:!1,checking:!1})}))}),[]);var p="http://localhost:3000/registration/verify?hash=".concat(window.localStorage.email_hash);return Object(s.jsx)("div",{className:"verify-block",children:Object(s.jsxs)(N,{children:[j?Object(s.jsx)("div",{className:"verify-block__loading",children:Object(s.jsx)(te.a,{size:"large"})}):Object(s.jsx)(rt.a,{status:g.status,title:g.title,subTitle:g.message,extra:"success"===g.status&&o&&Object(s.jsx)(w.a,{type:"primary",onClick:function(){return a.push("/login")},children:"\u0412\u043e\u0439\u0442\u0438"})}),o?"":Object(s.jsx)(w.a,{id:"verify_link",type:"primary",href:p,children:"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044c \u0430\u043a\u043a\u0430\u0443\u043d\u0442"})]})})};a(407);var ut=function(){return Object(s.jsx)("section",{className:"auth",children:Object(s.jsxs)("div",{className:"auth__content",children:[Object(s.jsx)(g.b,{exact:!0,path:"/login",component:tt}),Object(s.jsx)(g.b,{exact:!0,path:"/registration",component:it}),Object(s.jsx)(g.b,{exact:!0,path:"/registration/verify",component:lt})]})})},dt=(a(408),function(){return Object(s.jsx)("section",{className:"home",children:Object(s.jsxs)("div",{className:"chat",children:[Object(s.jsx)(Je,{}),Object(s.jsxs)("div",{className:"chat__dialog",children:[Object(s.jsxs)("div",{className:"chat__dialog-header",children:[Object(s.jsx)("div",{}),Object(s.jsx)("div",{className:"chat__dialog-header-center",children:Object(s.jsx)("b",{className:"chat__dialog-header-username",children:Object(s.jsx)(We,{})})}),Object(s.jsx)(w.a,{type:"link",shape:"circle",icon:Object(s.jsx)(M.a,{})})]}),Object(s.jsx)("div",{className:"chat__dialog-messages",children:Object(s.jsx)(Pe,{})}),Object(s.jsx)("div",{className:"chat__dialog-input",children:Object(s.jsx)(He,{})})]})]})})}),jt=Object(o.b)((function(e){return{isAuth:e.user.isAuth}}))((function(e){var t=e.isAuth;return Object(s.jsxs)("div",{className:"wrapper",children:[Object(s.jsx)(O.a,{children:Object(s.jsxs)(g.d,{children:[Object(s.jsx)(g.b,{exact:!0,path:["/login","/registration","/registration/verify"],component:ut}),Object(s.jsx)(g.b,{path:"/",render:function(){return t?Object(s.jsx)(dt,{}):Object(s.jsx)(g.a,{to:"/login"})}})]})}),Object(s.jsxs)("div",{id:"footer",children:[Object(s.jsx)("img",{src:"https://rs.school/images/rs_school_js.svg",alt:"logo",width:"150px"}),Object(s.jsx)("a",{href:"https://rs.school/js/",children:"RSS School"}),Object(s.jsx)("span",{children:"Chat 2021"}),Object(s.jsxs)("div",{className:"developers",children:[Object(s.jsx)("h3",{children:"developed by"}),Object(s.jsx)("a",{href:"https://github.com/DreamerAleksey",children:"Dreamer Aleksey"}),Object(s.jsx)("a",{href:"https://github.com/Voloshin-Sergei",children:"Voloshin Sergei"}),Object(s.jsx)("a",{href:"https://github.com/spbtne",children:"Nikita Tushin"})]})]})]})}));b.dispatch(Fe.fetchUserData()),r.a.render(Object(s.jsx)(o.a,{store:b,children:Object(s.jsx)(c.a.StrictMode,{children:Object(s.jsx)(jt,{})})}),document.getElementById("root"))}},[[409,1,2]]]);
//# sourceMappingURL=main.2c9c20ff.chunk.js.map